var x=Object.defineProperty;var I=(n,s,i)=>s in n?x(n,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[s]=i;var t=(n,s,i)=>(I(n,typeof s!="symbol"?s+"":s,i),i);const v=function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver(e=>{for(const h of e)if(h.type==="childList")for(const l of h.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function i(e){const h={};return e.integrity&&(h.integrity=e.integrity),e.referrerpolicy&&(h.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?h.credentials="include":e.crossorigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function a(e){if(e.ep)return;e.ep=!0;const h=i(e);fetch(e.href,h)}};v();class Q{constructor(s){t(this,"game");this.game=s}}class r{static getImage(s){return this.imgCaches.find(i=>i.name===s)}static imagesLoader(s){return new Promise(i=>{const a=s.map(e=>new Promise((h,l)=>{const c=new Image;c.onload=()=>{h({name:e.name,img:c})},c.onerror=()=>{l(new Error(`Failed to load image ${e.src}`))},c.src=e.src}));Promise.all(a).then(e=>{this.imgCaches=e,i("images is loaded")})})}}t(r,"imgCaches",[]);const p=class{constructor(s,i=1,a=1){t(this,"game");t(this,"x",0);t(this,"y",0);t(this,"speedX",1);t(this,"speedY",1);t(this,"img");t(this,"width");t(this,"height");t(this,"_fire",!1);var e;this.game=s,this.speedX=i,this.speedY=a,this.img=(e=r.getImage("ball"))==null?void 0:e.img,this.width=12,this.height=12}static getInstance(s,i,a){return this.instance=this.instance||new p(s,i,a),this.instance}fire(){this._fire=!this._fire}move(){this._fire&&((this.x>this.game.canvas.width-this.width||this.x<0)&&(this.speedX*=-1),(this.y>this.game.canvas.height-this.height||this.y<0)&&(this.speedY*=-1),this.y+=this.speedY,this.x+=this.speedX)}bounce(){this.speedY*=-1}};let g=p;t(g,"instance");const u=class{constructor(s){t(this,"game");t(this,"x",250);t(this,"y",350);t(this,"speed",4);t(this,"img");t(this,"width");t(this,"height");var i;this.game=s,this.img=(i=r.getImage("panel"))==null?void 0:i.img,this.width=60,this.height=15,console.log(this)}static getInstance(s){return this.instance=this.instance||new u(s),this.instance}moveRight(){this.x<this.game.canvas.width-this.width&&(this.x+=this.speed)}moveLeft(){this.x>0&&(this.x-=this.speed)}};let d=u;t(d,"instance");class E{constructor(s=0,i=0,a=1){t(this,"x",0);t(this,"y",0);t(this,"lives",3);t(this,"img");t(this,"width");t(this,"height");var e;this.x=s,this.y=i,this.lives=a,this.img=(e=r.getImage("block"))==null?void 0:e.img,this.width=60,this.height=12}beCollided(){this.lives--,this.lives<=0}}var C="./assets/block.ee18d01b.png",F="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAADVElEQVR42u1aLXDUQBQ+UYFAIBAIBAKBQFQgEAhExQkEohJRgWAYRH4Kg8wMAnECwXRuN8fMCQSioqICgaioQCCQFRUViIgTJypCk8yE95KUbHK5JG93L+GAzOzM3c1l9/18773vvWQw+H+l14XN7wSWuxNZfBLa/Eto8W/w+QwXfP8emu5RZLFpYLJngeFuxo6z0bvQgTW5DwK+B2E9WDFxzQObf4ps/rhzZSLLfYQWlhC6eoGHIpttr1yRi93xXYSCNsErFIH9t1YEF27AIf7KhM9XGFpspM0bsTO9AsJ/7EDw0mJfY5tfVxTe2YCNDrsXPl2QIE59Y3xL2vJ9Ci8qIeWJfmBTAydKTGQB2/aA2WXBoi68l3DOu/apsn22OVDJFkmMme5+ayVMNmzclJTnNeTscHf8kFInag2WVdj2AWa7Y+WqDnvQzmTby60hRw+8SowLB+HnJTHgyVTrSi8gMdOZOZCZ5nu7O1pTKxDACvgkrFLXIedlD+BvGvc/qILPTGlTk/8A976uq5zxy70b+J/kv4oGKsAImxEl8gVCxc/3rhL5lRI5hMbo3kAZo2BJjB01ei7njcDkL0T8TyQ2mf00P9wuF6YU72yE+T2vLWyI6RJayido/cI9ryY3ZbIRUp0c/2kPK51lEi+CS+H3k6YshOmz7LWs/oQ077tHKvn/uFi92bCM54Y06pdpAbnTg3ogQuiMpn1+eAaBuUQd8MWMRaIUmSdlFTgXcRza7hvpQmbyt8XmadEQrRSgQYgdluqHp1CJvRKM9qUgRApisPhvq0GnpEolsLgJxnCkgpiYRp3L+xDDqgoU4oCgAE75ZAvZH6EAjijlqIQAIR0KiMWQpIDhbkqROYx+TJ1NDLatAlihMQNhLOAEou1cdaEnQEwRYOQ3lX9iPzCj0G0cClf0wkk1Xd+GRqGl7FaBusae2tT3oUBtU6/TC4DTp9oVaBqrZFX5AZnaLmGs2KWlM1b+WcvYve0cKmlI9Lh8TiFoDRxsRJuYgQXXdribEDVjek3ssNZuvC5QhZNwHR9wlDxx3AtsVB8xrSiwu33IV+qYtrQ+H+7yMetf8aC7igAiM5Scq/b3qsHSlz2APiTtaTrjWXjZA6dp+csexQndP3v9ApEf0U3ijyPKAAAAAElFTkSuQmCC",R="./assets/lose_bg.13a5baab.png",Y="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAaCAIAAADOqG6yAAAACXBIWXMAAA7EAAAOxAGVKw4bAAAAEXRFWHRTb2Z0d2FyZQBTbmlwYXN0ZV0Xzt0AAAQsSURBVFiF7ZlNTBtXEMd/WfNh2FCMkYODtbAEWRAHIgvFKUUU0ZQ0UdQgJVWaQw49VBXqoZcI9dB7L1XVqsceqyrqpUlVF0VRUllRg6wUIkSLQ0isFtAqYOIanKAF85kedg1ramKbtdRG9e/03uzM23l/7bydtfc9/3KApRUKZKS8VCgolS1LK8K/ncLLREGsHCiIlQN5Feuoh9PufC5oxOXmYjsN2Tl3+zia/xRMiyW18fFZ2kWAOhcep/mc0vN4hv21eB1ZOTdJ1OU/hSKzCygjBEW6OojdAlhOpHfrO091Ovvv1xgAmun3UBTn6wALW9e89NenOAvg6KDfaFrk8wBASxuvGW5QAQ0n+SA5TcT4diSnbaXFtFjA4B2qOygRATY30vsEhikFwO3hMPjHdXsMgJ5aUFm10eXgx2gyZoobMX1Y24hX4Ho4mbWFde1Ga7qlXKQSHsWT0wqexXXdy2y4RNObBNNiubncihWAI1oBVvCJnOIyPcaVMGFFn8rNACHF4CFSb2PhTxISshu2xIoT0jYv82YlE78SigBIrVyQCQa4q6bcaDOBf1gf90nEhhkA4PjruMztMolJscJ8Ed6eXToLE1zZYclEg4caGBrlSTlvO+iEQeNlkUutrM/hj+gGZYwJJ50+Ht421CwIVnp9+tgK1T56ASizwi6HQ47kowx1RF4pZjrMQRuzyXLYX8zsTIY4r53VeX4GFN5w0uRlcHR7zXOd1EN4g14flTasYLVSKlBiodfDN+MvWDjv5FGsQ1SqxDt4r5rbhhrZVF8YJVMnshClRQKIJGisoQEmtasqwibRBM5ahKdMxpmzckzghxESEhdlvONsCfufL0MDbzlYXiQYxH5SfzmGMwdxXEIEUaZXNhhlJqf08dVbAOdOYY/hH4M2jll5EIUoP0ncNyz10pRhlZsWG4/uAAwEqemhy0t4FDLl2WRHjfBVMDkXef8ULgmmDE4iB0SeRHbG3ld2WtKyHGc8ntktC/IilpN3PazMMKC9yFQCIyQUcCOu8Wz3uCovLgt/GPes8nCeLnvKMd/eRpXKzWiaFfrOM32NG7CkMqfiTzZTxjLUONPBXxMMze95k+Shgz94iA9fpewpN+9uGycVZsFdTYnK0O6xPjuCyr3UB2QwwqqFJi8AIj3ddNsJ/ZY8xYzIWNfQHprQyM62UzD2ViL1Tg6YUgrY9/zTq3uP9rZzupaYwvfDKZ33Rw4SUFWBMsZ32Rxd6ZA8vNOMsMgvw9zbqqNmLnso2mATBAvE+SyQJvbCGRqLWTdYStbwXye0x1w0zImFgyNr3N9xIogctmOBjQQP0tVO9ridhP9xVFU5cGl98AaPZ1JarZRYSf9m0IgpzJrKBdNi/b8o/J6VAwWxcqAgVg4UxMoBgfLSzF4F0P43PNFS0Csz5aWcaPkbjG86K5W4xJIAAAAASUVORK5CYII=",L="./assets/play_sense_bg.f25c19e1.png";const y=(n,s)=>n.x<s.x+s.width&&n.x+n.width>s.x&&n.y<s.y+s.height&&n.y+n.height>s.y;function o(n){return new URL({"/src/assets/block.png":C,"/src/assets/coin.png":F,"/src/assets/lose_bg.png":R,"/src/assets/panel.png":Y,"/src/assets/play_sense_bg.png":L}[`/src/assets/${n}`],self.location).href}const f=class extends Q{constructor(s){super(s);t(this,"panel");t(this,"ball");t(this,"blocks",[]);t(this,"score",0);this.panel=d.getInstance(s),this.ball=g.getInstance(s);const i=this.game.canvas.width;for(var a=0;a<4;a++)this.blocks.push(new E(Math.random()*i,a*100,a));s.registerAction("a",()=>{this.panel.moveLeft()}),s.registerAction("d",()=>{this.panel.moveRight()}),addEventListener("keydown",e=>{e.code==="Space"&&this.ball.fire()}),document.getElementsByClassName("rangeInput")[0].addEventListener("input",e=>{var h,l,c,b;this.ball.speedX<0?this.ball.speedX=-((h=e==null?void 0:e.target)==null?void 0:h.value)/10:this.ball.speedX=((l=e==null?void 0:e.target)==null?void 0:l.value)/10,this.ball.speedY<0?this.ball.speedY=-((c=e==null?void 0:e.target)==null?void 0:c.value)/10:this.ball.speedY=((b=e==null?void 0:e.target)==null?void 0:b.value)/10})}registerAction(){}cancelAction(){}static getInstance(s){return this.instance=this.instance||new f(s),this.instance}draw(){var a;this.game.ctx.drawImage((a=r.getImage("play_sense_bg"))==null?void 0:a.img,0,0,this.game.canvas.width,this.game.canvas.height),this.game.ctx.drawImage(this.panel.img,this.panel.x,this.panel.y,this.panel.width,this.panel.height),this.game.ctx.drawImage(this.ball.img,this.ball.x,this.ball.y,this.ball.width,this.ball.height);for(var s=0;s<this.blocks.length;s++){var i=this.blocks[s];y(this.ball,i)&&(i.beCollided(),i.lives===0&&(this.blocks.splice(s,1),this.score=this.score+20),this.ball.bounce()),i.lives>0&&this.game.ctx.drawImage(i.img,i.x,i.y,i.width,i.height)}this.updateScore()}updateScore(){this.game.ctx.font="20px Arial",this.game.ctx.fillStyle="#fff",this.game.ctx.fillText("\u5206\u6570: "+this.score,10,290)}update(){y(this.ball,this.panel)&&this.ball.bounce(),this.ball.move()}};let A=f;t(A,"instance");const w=class{constructor(s,i=30){t(this,"canvas");t(this,"ctx");t(this,"sense");t(this,"images",{});t(this,"actions",{});t(this,"keyDowns",{});this.canvas=s,this.ctx=s.getContext("2d"),this.sense=A.getInstance(this),window.addEventListener("keydown",a=>{this.keyDowns[a.key]=!0}),window.addEventListener("keyup",a=>{this.keyDowns[a.key]=!1}),this.update()}static getInstance(s,i=30){return this.instance=this.instance||new w(s,i),this.instance}update(){Object.keys(this.actions).forEach(s=>{this.keyDowns[s]&&this.actions[s]()}),this.sense.update(),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.sense.draw(),requestAnimationFrame(this.update.bind(this))}registerAction(s,i){this.actions[s]=i}cancelAction(s){this.actions[s]=null}transitionSense(s){this._sense=s}};let m=w;t(m,"instance");let M=[{name:"ball",src:o("coin.png")},{name:"lose_bg",src:o("lose_bg.png")},{name:"panel",src:o("panel.png")},{name:"play_sense_bg",src:o("play_sense_bg.png")},{name:"coin",src:o("coin.png")},{name:"block",src:o("block.png")}];(async()=>{await r.imagesLoader(M),m.getInstance(document.getElementById("canvas"),30)})();
